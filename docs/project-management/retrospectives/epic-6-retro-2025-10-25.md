# Epic 6 Retrospective — Security & Validation

Date: 2025-10-25
Facilitator: Bob (Scrum Master)

Epic: Epic 6 — Security & Validation
Status: Hoàn thành (3/3 stories done)

## Điều Đã Làm Tốt
- Zod schema validation (6.1) giúp chuẩn hóa đầu vào và giảm rủi ro lỗi.
- Protocol validation (6.2) chặn schemes không an toàn và tình huống open redirect.
- Domain allowlist (6.3) cung cấp governance linh hoạt theo môi trường.
- Bộ test đơn vị + tích hợp cho các nhánh 400/403 hoạt động ổn định.

## Cần Cải Thiện
- Rà soát sớm hơn hành vi bootstrap/legacy để đồng bộ thông điệp lỗi.
- Làm rõ tiêu chí khớp domain (exact/subdomain) trong docs để tránh overmatching.
- Bổ sung guideline tránh lộ thông tin nhạy cảm trong thông báo lỗi.

## Bài Học Rút Ra
1. “Validate early, fail fast” giúp giữ mục tiêu hiệu năng và giảm rủi ro bảo mật.
2. Duy trì error JSON thống nhất để đơn giản hóa test và observability.
3. Allowlist nên có tài liệu ví dụ rõ ràng (exact/subdomain) và cảnh báo trường hợp biên.

## Action Items (Chủ Trì)
- Chuẩn hóa thông điệp lỗi 400/403 cho các nhánh validation (Dev).
- Viết hướng dẫn chi tiết về allowlist (matching rules, ví dụ, anti‑patterns) (SM/Dev).
- Mở rộng test biên cho domain parsing và URL edge cases (Dev).

## Chuẩn Bị Cho Epic Tiếp Theo
- Tiếp tục Epic 7 (Analytics Abstraction): hoàn thiện neutral model, router, registry, timeout, logging.
- Song song chuẩn bị Epic 8 (GA4 Integration) dựa trên abstraction để giảm coupling.
- Kiểm tra lại cấu hình môi trường (env) cho chế độ bảo mật trước khi bật tracking end‑to‑end.

## Metrics
- Stories Planned: 3
- Stories Done: 3
- Blockers: none

---
Approved by: vanTT

